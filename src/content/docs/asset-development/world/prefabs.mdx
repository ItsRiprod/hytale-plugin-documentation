---
title: "Prefab Structures"
---

{/* [VERIFIED: 2026-01-20] */}

import { Aside, Tabs, TabItem, FileTree } from '@astrojs/starlight/components';

Prefabs are pre-built block structures used for world generation and spawning. They range from simple trees to complex dungeon rooms, monuments, and NPC camps.

## Asset Location

<FileTree>
- Assets/Server/Prefabs/
  - Cave/
    - Formations/
    - Geysers/
    - Klops/
  - Dungeon/
    - Challenge_Gate/
    - Cursed_Crypt/
    - Goblin_Lair/
    - Labyrinth/
    - Magic_Ruins/
    - Outlander_Temple/
    - Rift/
    - Sandstone/
    - Sewer/
    - Shale/
    - Slate/
    - Stone/
  - Mineshaft/
  - Mineshaft_Drift/
  - Monuments/
    - Challenge/
    - Encounter/
    - Incidental/
    - Story/
    - Unique/
  - Npc/
  - Plants/
  - Rock_Formations/
  - Spawn/
  - Testing/
  - Trees/
    - Oak/
    - Birch/
    - Ash/
    - Pine/
    - (70+ tree types)
  - Example_Portal1.prefab.json
  - default.minigame.prefab.json
</FileTree>

## Prefab Schema

### Core Properties

| Field | Type | Description |
|-------|------|-------------|
| `version` | `int` | Prefab format version |
| `blockIdVersion` | `int` | Block ID mapping version |
| `anchorX` | `int` | X anchor point |
| `anchorY` | `int` | Y anchor point |
| `anchorZ` | `int` | Z anchor point |
| `blocks` | `array` | Block placement data |

### Block Entry Properties

| Field | Type | Description |
|-------|------|-------------|
| `x` | `int` | X offset from anchor |
| `y` | `int` | Y offset from anchor |
| `z` | `int` | Z offset from anchor |
| `name` | `string` | Block type ID |
| `rotation` | `int` | Optional rotation (0-3) |

## File Format

Prefabs use `.prefab.json` extension with optional `.prefab.json.lpf` compressed variant:

```json title="Example_Portal1.prefab.json"
{
  "version": 8,
  "blockIdVersion": 1,
  "anchorX": 0,
  "anchorY": 0,
  "anchorZ": 0,
  "blocks": [
    {
      "x": -1,
      "y": 0,
      "z": -2,
      "name": "Rock_Aqua_Brick"
    },
    {
      "x": -1,
      "y": 1,
      "z": -2,
      "name": "Rock_Aqua_Brick"
    },
    {
      "x": 1,
      "y": 0,
      "z": -1,
      "name": "Rock_Aqua_Brick_Stairs",
      "rotation": 1
    }
  ]
}
```

## Prefab Categories

### Trees

Located in `Trees/`, organized by species and growth stage:

<FileTree>
- Trees/
  - Oak/
    - Stage_0/
      - Oak_Stage0_001.prefab.json
      - Oak_Stage0_002.prefab.json
    - Stage_1/
    - Stage_2/
    - Stage_3/
    - Stage_4/
    - Stage_5/
    - Stage_6/
    - Stage_7/
    - Stumps/
  - Birch/
  - Pine/
  - ...
</FileTree>

**Stage System**:
| Stage | Description |
|-------|-------------|
| `Stage_0` / `Stage_00` | Sapling/small |
| `Stage_1` - `Stage_3` | Growing sizes |
| `Stage_4` - `Stage_5` | Medium trees |
| `Stage_6` - `Stage_7` | Large/giant trees |
| `Stumps` | Cut tree remains |

**Tree Types** (70+ species):
- Temperate: Oak, Birch, Beech, Ash, Aspen
- Autumn: Autumn, Amber
- Magical: Azure, Hedera
- Tropical: Banyan, Bamboo, Palm
- Cold: Pine, Spruce, Fir, Boreal
- Dead: Ash_Dead, Beech_Dry

### Cave Formations

Located in `Cave/`:

| Directory | Contents |
|-----------|----------|
| `Formations/Rock_Stone/` | Stone stalactites/stalagmites |
| `Formations/Rock_Sandstone/` | Sandstone formations |
| `Formations/Rock_Volcanic/` | Volcanic rock formations |
| `Geysers/` | Geyser prefabs |
| `Klops/` | Klops (troll) cave dwellings |

**Klops Cave Structure**:

<FileTree>
- Klops/Basalt/
  - Start/ Entry room
  - Main/ Main living area
  - Main_2/ Secondary room
  - Main_3/ Tertiary room
  - Bedroom/ Sleeping area
  - Bathroom/ Utility room
  - Cellar/ Storage
  - Cave/ Natural cave section
  - Stairs_Up/ Upper connection
  - Stairs_Down/ Lower connection
  - Entrance/ Cave entrance
</FileTree>

### Dungeons

Located in `Dungeon/`, organized by dungeon type:

| Dungeon | Description |
|---------|-------------|
| `Challenge_Gate/` | Challenge room structures |
| `Cursed_Crypt/` | Undead dungeon areas |
| `Goblin_Lair/` | Goblin cave rooms |
| `Labyrinth/` | Maze-like structures |
| `Magic_Ruins/` | Ancient magical ruins |
| `Outlander_Temple/` | Outlander faction temple |
| `Rift/` | Dimensional rift areas |
| `Sewer/` | Underground sewer system |
| `Stone/` | Generic stone dungeon |
| `Shale/` | Shale rock dungeon |
| `Slate/` | Slate rock dungeon |
| `Sandstone/` | Desert dungeon |

### Monuments

Located in `Monuments/`:

| Category | Description |
|----------|-------------|
| `Challenge/` | Combat challenge arenas |
| `Encounter/` | NPC encounter locations |
| `Incidental/` | Small points of interest |
| `Story/` | Story-related structures |
| `Unique/` | One-of-a-kind locations |

### NPC Camps

Located in `Npc/`:
- Camp structures
- Faction buildings
- NPC spawn points

### Plants

Located in `Plants/`:
- Bushes and shrubs
- Flowers and grass
- Crops and farming plants

### Rock Formations

Located in `Rock_Formations/`:
- Natural rock outcrops
- Boulder clusters
- Cliff faces

### Mineshafts

| Directory | Description |
|-----------|----------|
| `Mineshaft/` | Standard mine tunnels |
| `Mineshaft_Drift/` | Drift mine structures |

## Examples

### Simple Tree Prefab

```json title="Oak_Stage0_001.prefab.json"
{
  "version": 8,
  "blockIdVersion": 3,
  "anchorX": 0,
  "anchorY": 0,
  "anchorZ": 0,
  "blocks": [
    { "x": 0, "y": 0, "z": 0, "name": "Plant_Trunk_Oak" },
    { "x": 0, "y": 1, "z": 0, "name": "Plant_Trunk_Oak" },
    { "x": 0, "y": 2, "z": 0, "name": "Plant_Trunk_Oak" },
    { "x": 0, "y": 3, "z": 0, "name": "Plant_Leaves_Oak" },
    { "x": -1, "y": 3, "z": 0, "name": "Plant_Leaves_Oak" },
    { "x": 1, "y": 3, "z": 0, "name": "Plant_Leaves_Oak" },
    { "x": 0, "y": 3, "z": -1, "name": "Plant_Leaves_Oak" },
    { "x": 0, "y": 3, "z": 1, "name": "Plant_Leaves_Oak" },
    { "x": 0, "y": 4, "z": 0, "name": "Plant_Leaves_Oak" }
  ]
}
```

### Structure with Rotation

```json title="default.minigame.prefab.json"
{
  "version": 8,
  "blockIdVersion": 0,
  "anchorX": 0,
  "anchorY": 0,
  "anchorZ": 0,
  "blocks": [
    {
      "x": -1,
      "y": 0,
      "z": 0,
      "name": "Furniture_Village_Window",
      "rotation": 1
    },
    {
      "x": -1,
      "y": 1,
      "z": 0,
      "name": "Furniture_Village_Window",
      "rotation": 1
    },
    {
      "x": 0,
      "y": 0,
      "z": -1,
      "name": "Furniture_Village_Window"
    },
    {
      "x": 0,
      "y": -1,
      "z": 0,
      "name": "Rock_Gold_Brick"
    },
    {
      "x": 0,
      "y": 2,
      "z": 0,
      "name": "Deco_Lantern"
    }
  ]
}
```

### Empty Placeholder

```json title="Dungeon_Empty.prefab.json"
{
  "version": 8,
  "blockIdVersion": 8,
  "anchorX": 0,
  "anchorY": 0,
  "anchorZ": 0,
  "blocks": [
    { "x": 0, "y": 0, "z": 0, "name": "Empty" },
    { "x": 0, "y": 1, "z": 0, "name": "Empty" }
  ]
}
```

The `Empty` block type clears existing blocks at that position.

## Rotation Values

| Value | Direction |
|-------|-----------|
| `0` | North (default) |
| `1` | East (90°) |
| `2` | South (180°) |
| `3` | West (270°) |

## Anchor Points

The anchor point (`anchorX`, `anchorY`, `anchorZ`) defines where the prefab is placed relative to its spawn position:

- **X/Z = 0**: Prefab centered on placement point
- **Y = 0**: Bottom of prefab at placement height

Block coordinates are relative to this anchor.

## Compressed Format (.lpf)

Large prefabs have accompanying `.prefab.json.lpf` files containing compressed binary data for faster loading.

## Creating Custom Prefabs

```json title="MyPlugin_Structure.prefab.json"
{
  "version": 8,
  "blockIdVersion": 1,
  "anchorX": 0,
  "anchorY": 0,
  "anchorZ": 0,
  "blocks": [
    { "x": 0, "y": 0, "z": 0, "name": "Rock_Stone_Brick" },
    { "x": 1, "y": 0, "z": 0, "name": "Rock_Stone_Brick" },
    { "x": 0, "y": 0, "z": 1, "name": "Rock_Stone_Brick" },
    { "x": 1, "y": 0, "z": 1, "name": "Rock_Stone_Brick" },
    { "x": 0, "y": 1, "z": 0, "name": "Rock_Stone_Brick" },
    { "x": 1, "y": 1, "z": 0, "name": "Rock_Stone_Brick" },
    { "x": 0, "y": 1, "z": 1, "name": "Rock_Stone_Brick" },
    { "x": 1, "y": 1, "z": 1, "name": "Rock_Stone_Brick" },
    { "x": 0, "y": 2, "z": 0, "name": "Rock_Stone_Brick_Stairs" },
    { "x": 1, "y": 2, "z": 0, "name": "Rock_Stone_Brick_Stairs", "rotation": 2 },
    { "x": 0, "y": 2, "z": 1, "name": "Rock_Stone_Brick_Stairs", "rotation": 1 },
    { "x": 1, "y": 2, "z": 1, "name": "Rock_Stone_Brick_Stairs", "rotation": 3 }
  ]
}
```

## Block Naming Conventions

Prefabs use standard block type IDs:

| Category | Pattern | Examples |
|----------|---------|----------|
| Rock | `Rock_[Material]_[Variant]` | `Rock_Stone_Brick`, `Rock_Aqua_Brick_Ornate` |
| Wood | `Wood_[Type]_[Variant]` | `Wood_Oak_Planks` |
| Plants | `Plant_[Type]_[Species]` | `Plant_Leaves_Oak`, `Plant_Trunk_Birch` |
| Furniture | `Furniture_[Set]_[Item]` | `Furniture_Village_Window` |
| Decoration | `Deco_[Type]` | `Deco_Lantern` |
| Empty | `Empty` | Clears block |

## Best Practices

1. **Use meaningful anchor points** - Center on logical placement position
2. **Include rotation for directional blocks** - Doors, stairs, etc.
3. **Keep coordinates reasonable** - Large prefabs impact performance
4. **Use Empty strategically** - Clear unwanted terrain
5. **Version your prefabs** - Use current version number (8)
6. **Match blockIdVersion** - Ensure block IDs are valid for version

## World Generation Integration

Prefabs are placed during world generation based on:
- Biome rules
- Terrain conditions
- Random distribution
- Dungeon node graphs

## Related

- [Block Types](/asset-development/blocks/block-types/) - Block definitions
- [World Instances](/asset-development/world/instances/) - Instance configuration
- [Environments](/asset-development/world/environments/) - Environment settings
- [World Generation](/plugin-development/worldgen/overview/) - World generation system
